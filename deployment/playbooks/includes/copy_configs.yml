  #TODO: is this the desired logic here? Right now if there's no configs dir local (for agent configurations) we create an empty dir on the remote and create no errors.
  #TODO in the example this file contains platform configuration data (bus, vip, etc.); this is partially redundant with the inventory file, which is bad... is one defunct, can they be merged and where?
  - name: check locally for configuration root directory
    local_action:
      module: stat
      path: "{{ deployment_config_root }}"
    register: directory_check
    ignore_errors: True
    run_once: True
    vars:
      ## we changed pythons to install deps on the remotes, need
      ## to set back because we're deleagting to localhost
      ansible_python_interpreter: "{{ ansible_playbook_python }}"

  - name: ensure remote has configs dir
    file:
      path: "{{ host_configs_dir }}"
      state: directory
      mode: 0755

  - name: copy configs dir to remote
    copy:
      # Note the / on the end means we don't want the containing folder
      # only the files underneath.  So ignore 'sigma1' if it was the
      # host.
      src: "{{ deployment_platform_config_dir }}/"
      dest: "{{ host_configs_dir }}"
      mode: 0644
    when: directory_check.stat.exists

  - name: Copy host config to remote
    copy:
      src: "{{ deployment_platform_config_file }}"
      dest: "{{ host_config }}"
      mode: 0644
